<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>図形ウォンテッド！</title>
    <style>
        body { text-align: center; font-family: 'Comic Sans MS', sans-serif; background: #222; color: white; margin: 0; }
        .header { background: #444; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        #game-board { 
            position: relative; width: 90vw; height: 70vh; 
            margin: 20px auto; background: #333; border: 4px solid #555; overflow: hidden;
        }
        .shape { 
            position: absolute; cursor: pointer; transition: transform 0.1s; 
            display: flex; align-items: center; justify-content: center;
        }
        .shape:hover { transform: scale(1.1); filter: brightness(1.2); }
        .target-box { font-size: 28px; margin-bottom: 10px; }
        .target-symbol { display: inline-block; vertical-align: middle; margin-left: 10px; }
        #timer { color: #ff4757; font-size: 32px; font-weight: bold; }
        
        /* 各種図形の描画用クラス */
        .circle { border-radius: 50%; }
        .star { clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); }
        .diamond { transform: rotate(45deg); }
    </style>
</head>
<body>

<div class="header">
    <div class="target-box">
        さがせ！：<div id="target-ui" class="target-symbol"></div>
    </div>
    <div>Time: <span id="timer">30</span> | Level: <span id="level">1</span></div>
</div>

<div id="game-board"></div>

<script>
    const board = document.getElementById('game-board');
    const targetUI = document.getElementById('target-ui');
    const timerEl = document.getElementById('timer');
    const levelEl = document.getElementById('level');

    const shapeConfigs = [
        { id: 'circle', color: '#ff4757' },
        { id: 'square', color: '#1e90ff' },
        { id: 'triangle', color: '#2ed573' },
        { id: 'star', color: '#ffa502' },
        { id: 'diamond', color: '#e056fd' }
    ];

    let score = 0;
    let timeLeft = 30;
    let level = 1;

    function initLevel() {
        board.innerHTML = '';
        // 正解を1つ選ぶ
        const correct = shapeConfigs[Math.floor(Math.random() * shapeConfigs.length)];
        
        // 正解表示の更新
        updateTargetUI(correct);

        // 図形をたくさん配置（レベルが上がるごとに増える）
        const count = 20 + (level * 10);
        
        // 1つだけ正解を配置
        createShape(correct, true);
        
        // 残りはハズレを配置
        for (let i = 0; i < count; i++) {
            let wrong;
            do {
                wrong = shapeConfigs[Math.floor(Math.random() * shapeConfigs.length)];
            } while (wrong.id === correct.id); // 正解と同じ形は出さない
            createShape(wrong, false);
        }
    }

    function createShape(config, isCorrect) {
        const div = document.createElement('div');
        div.className = `shape ${config.id}`;
        const size = 50;
        
        // ランダム配置
        div.style.left = Math.random() * (board.clientWidth - size) + 'px';
        div.style.top = Math.random() * (board.clientHeight - size) + 'px';
        div.style.width = size + 'px';
        div.style.height = size + 'px';
        div.style.backgroundColor = config.color;

        // 三角形だけは別処理
        if (config.id === 'triangle') {
            div.style.backgroundColor = 'transparent';
            div.style.borderLeft = '25px solid transparent';
            div.style.borderRight = '25px solid transparent';
            div.style.borderBottom = `50px solid ${config.color}`;
        }

        div.onclick = () => {
            if (isCorrect) {
                level++;
                levelEl.innerText = level;
                timeLeft += 2; // ボーナス時間
                initLevel();
            } else {
                timeLeft -= 3; // ペナルティ
                div.style.opacity = '0.3'; // 間違えたやつを半透明に
            }
        };
        board.appendChild(div);
    }

    function updateTargetUI(config) {
        targetUI.className = `target-symbol ${config.id}`;
        targetUI.style.width = '40px';
        targetUI.style.height = '40px';
        targetUI.style.backgroundColor = config.color;
        if (config.id === 'triangle') {
            targetUI.style.backgroundColor = 'transparent';
            targetUI.style.borderLeft = '20px solid transparent';
            targetUI.style.borderRight = '20px solid transparent';
            targetUI.style.borderBottom = `40px solid ${config.color}`;
        }
    }

    // カウントダウン
    const timerId = setInterval(() => {
        timeLeft--;
        timerEl.innerText = Math.max(0, timeLeft);
        if (timeLeft <= 0) {
            clearInterval(timerId);
            alert("GAME OVER! 到達レベル: " + level);
            location.reload();
        }
    }, 1000);

    initLevel();
</script>
</body>
</html>
